<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd">

  <context:annotation-config/>

  <import resource="test-commerce-services.xml"/>

  <context:property-placeholder
          ignore-unresolvable="true"
          location="/com.coremedia.livecontext.ecommerce.ibm.service/test-commerce-services.properties"
          system-properties-mode="OVERRIDE"/>


  <bean name="commerce:wcs1" class="com.coremedia.livecontext.ecommerce.ibm.common.CommerceConnectionImpl"
        scope="prototype">
    <property name="storeContextProvider" ref="storeContextProvider"/>
    <property name="userContextProvider" ref="userContextProvider"/>
    <property name="catalogService" ref="catalogService"/>
    <property name="marketingSpotService" ref="marketingSpotService"/>
    <property name="segmentService" ref="segmentService"/>
    <property name="cartService" ref="cartService"/>
    <property name="availabilityService" ref="availabilityService"/>
    <property name="searchService" ref="searchService"/>
    <property name="workspaceService" ref="workspaceService"/>
    <property name="assetUrlProvider" ref="assetUrlProvider"/>
    <property name="idProvider" ref="commerceIdProvider"/>
    <property name="commerceBeanFactory" ref="commerceBeanFactory"/>
    <property name="vendorUrl" value="test/connection/url"/>
    <property name="vendorVersion" value="7.7"/>
    <property name="vendorName" value="IBM"/>
  </bean>

  <bean id="catalogWrapperService" class="com.coremedia.livecontext.ecommerce.ibm.catalog.WcCatalogWrapperService">
    <property name="restConnector" ref="restConnector"/>
    <property name="useSearchRestHandlerProductIfAvailable" value="true" />
    <property name="useSearchRestHandlerCategoryIfAvailable" value="true" />
  </bean>

  <bean id="catalogService" class="com.coremedia.livecontext.ecommerce.ibm.catalog.CatalogServiceImpl">
    <property name="catalogWrapperService" ref="catalogWrapperService"/>
    <property name="commerceBeanFactory" ref="commerceBeanFactory"/>
    <property name="commerceCache" ref="commerceCache"/>
    <property name="wcsUrl" value="${livecontext.ibm.wcs.url}"/>
    <property name="wcsStoreUrl" value="${livecontext.ibm.wcs.store.url}"/>
    <property name="wcsAssetsUrl" value="${livecontext.ibm.wcs.assets.url}"/>
  </bean>

  <!-- commerce bean definitions -->
  <bean name="abstractCommerceBean" scope="prototype" abstract="true"
        class="com.coremedia.livecontext.ecommerce.ibm.common.AbstractIbmCommerceBean">
    <property name="commerceBeanFactory" ref="commerceBeanFactory"/>
    <property name="catalogService" ref="catalogService"/>
    <property name="commerceCache" ref="commerceCache"/>
  </bean>

  <bean name="commerceBeanFactory:product" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.catalog.ProductImpl" scope="prototype">
    <property name="availabilityService" ref="availabilityService"/>
    <property name="catalogWrapperService" ref="catalogWrapperService"/>
  </bean>
  <bean name="commerceBeanFactory:sku" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.catalog.ProductVariantImpl" scope="prototype">
    <property name="catalogWrapperService" ref="catalogWrapperService"/>
  </bean>
  <bean name="commerceBeanFactory:segment" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.p13n.SegmentImpl" scope="prototype"/>
  <bean name="commerceBeanFactory:contract" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.contract.ContractImpl" scope="prototype">
    <property name="contractWrapperService" ref="contractWrapperService"/>
  </bean>
  <bean name="commerceBeanFactory:category" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.catalog.CategoryImpl" scope="prototype">
    <property name="catalogWrapperService" ref="catalogWrapperService"/>
  </bean>

  <bean name="commerceBeanFactory:cart" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.order.CartImpl" scope="prototype"/>
  <bean name="commerceBeanFactory:marketingspot" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.p13n.MarketingSpotImpl" scope="prototype">
    <property name="marketingSpotWrapperService" ref="marketingSpotWrapperService"/>
  </bean>
  <bean name="commerceBeanFactory:person" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.user.UserImpl" scope="prototype"/>
  <bean name="commerceBeanFactory:workspace" parent="abstractCommerceBean"
        class="com.coremedia.livecontext.ecommerce.ibm.workspace.WorkspaceImpl" scope="prototype"/>

</beans>