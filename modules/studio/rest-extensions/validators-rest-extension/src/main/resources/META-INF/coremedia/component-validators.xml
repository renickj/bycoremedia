<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd">

  <import resource="classpath:com/coremedia/rest/cap/cap-rest-service.xml"/>
  <import resource="classpath:com/coremedia/cap/common/uapi-services.xml"/>
  <import resource="classpath:/com/coremedia/blueprint/base/multisite/bpbase-multisite-services.xml"/>
  <import resource="classpath:/com/coremedia/blueprint/base/links/bpbase-links-services.xml"/>

  <bean id="channelWriteInterceptor" class="com.coremedia.blueprint.studio.rest.intercept.ChannelWriteInterceptor">
    <property name="type" value="CMChannel"/>
    <property name="propertyName" value="segment"/>
    <property name="urlPathFormattingHelper" ref="urlPathFormattingHelper"/>
  </bean>

  <bean id="siteWriteInterceptor" class="com.coremedia.blueprint.studio.rest.intercept.SiteWriteInterceptor">
    <property name="type" value="CMSite"/>
    <property name="siteModel" ref="siteModel"/>
  </bean>

  <bean id="cmLocalizedValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMLocalized"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.cap.validators.LinkListMaxLengthValidator">
          <property name="property" value="master"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmTeaserValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMTeaser"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.cap.validators.LinkListMaxLengthValidator">
          <property name="property" value="target"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmPictureValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMPicture"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="data"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmImageMapValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMImageMap"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="target"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmImageMapAreasValidator" class="com.coremedia.rest.cap.validators.ImageMapAreasValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMImageMap"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="imagePropertyPath" value="pictures.data"/>
    <property name="structProperty" value="localSettings"/>
  </bean>

  <bean id="cmLinkListValidator" class="com.coremedia.blueprint.studio.rest.validators.SelfReferringLinkListValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMLinkable"/>
    <property name="validatingSubtypes" value="true"/>
  </bean>

  <bean id="cmChannelSegmentValidator" class="com.coremedia.blueprint.studio.rest.validators.ChannelSegmentValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMChannel"/>
  </bean>

  <bean id="cmTeaserTargetValidator" class="com.coremedia.blueprint.studio.rest.validators.TeaserLinkTargetValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMTeaser"/>
    <property name="validatingSubtypes" value="true"/>
  </bean>

  <bean id="cmChannelNavigationValidator"
        class="com.coremedia.blueprint.studio.rest.validators.ChannelNavigationValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMChannel"/>
  </bean>

  <bean id="cmNotInNavigationValidator"
        class="com.coremedia.blueprint.studio.rest.validators.ChannelIsPartOfNavigationValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMChannel"/>
  </bean>

  <bean id="cmChannelReferrerValidator"
        class="com.coremedia.blueprint.studio.rest.validators.ChannelReferrerValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMChannel"/>
  </bean>

  <bean id="cmAbstractCodeValidator" class="com.coremedia.blueprint.studio.rest.validators.AbstractCodeValidator">
    <property name="connection" ref="connection"/>
    <property name="contentType" value="CMAbstractCode"/>
    <property name="validatingSubtypes" value="true"/>
  </bean>
  <!--
     All Document Types with title property not empty validation
  -->
  <bean id="cmArticleValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMArticle"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="title"/>
        </bean>
        <bean class="com.coremedia.blueprint.studio.rest.validators.NotEmptyMarkupValidator">
          <property name="property" value="detailText"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="masterVersionUpdatedValidator" class="com.coremedia.rest.cap.validators.MasterVersionUpdatedValidator">
    <property name="connection" ref="connection"/>
    <property name="sitesService" ref="sitesService"/>
    <property name="contentType" value="CMLocalized"/>
    <property name="validatingSubtypes" value="true"/>
  </bean>

  <bean id="crossSiteLinkValidator" class="com.coremedia.rest.cap.validators.CrossSiteLinkValidator">
    <property name="connection" ref="connection"/>
    <property name="sitesService" ref="sitesService"/>
    <property name="contentType" value="CMLocalized"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="excludedProperties" value=""/>
    <property name="defaultSeverity" value="WARN"/>
    <property name="severityCrossLocale" value="WARN"/>
    <property name="severityCrossSite" value="WARN"/>
    <property name="severityCrossSiteLocale" value="WARN"/>
  </bean>

  <bean id="cmAudioValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMAudio"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="title"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmDownloadValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMDownload"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="title"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmExternalLinkValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMExternalLink"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="url"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmGalleryValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMGallery"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="title"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmVideoValidator" parent="contentTypeValidator">
    <property name="contentType" value="CMVideo"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="validators">
      <list>
        <bean class="com.coremedia.rest.validators.NotEmptyValidator">
          <property name="property" value="title"/>
        </bean>
      </list>
    </property>
  </bean>

  <bean id="cmSiteValidator" class="com.coremedia.rest.cap.validators.SiteNameValidator"
        parent="contentTypeValidator">
    <property name="contentType" value="CMSite"/>
    <property name="validatingSubtypes" value="true"/>
    <property name="siteModel" ref="siteModel"/>
  </bean>

  <bean id="callToActionConfigurationPropertyInferrer"
        class="com.coremedia.blueprint.studio.rest.propertyinferrer.CallToActionConfigurationPropertyInferrer">
    <property name="type" value="CMTeasable"/>
    <property name="applicableToSubtypes" value="true"/>
  </bean>
</beans>
