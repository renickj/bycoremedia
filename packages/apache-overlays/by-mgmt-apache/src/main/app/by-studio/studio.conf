<VirtualHost *:@STUDIO_APACHE_HTTP_PORT@>
  ServerName @STUDIO_BY_SEGMENT@.@BY_STUDIO_TLD@

  ### Temporary Bugfix for STUDIO-757 ###
  #AllowEncodedSlashes NoDecode
  ######

  <Proxy balancer://studio-cluster>
    BalancerMember http://@STUDIO_HOST@:@STUDIO_HTTP_PORT@ route=@STUDIO_JVM_ROUTE@ loadfactor=1 ttl=300
  </Proxy>

  # Needed for local development, where the studio and the cae run on different tomcats. For
  # retest or production systems this balancer should be the same as the studio cluster
  <Proxy balancer://preview-cluster>
      BalancerMember http://@BY_PREVIEW_HOST@:@TENANT_PREVIEW_HTTP_PORT@ route=@TENANT_PREVIEW_JVM_ROUTE@ loadfactor=1 ttl=300
  </Proxy>

  Include conf.d/by-studio/*.inc

</VirtualHost>

<VirtualHost *:@STUDIO_APACHE_HTTPS_PORT@>
  ServerName @STUDIO_BY_SEGMENT@.@BY_STUDIO_TLD@

  ### Temporary Bugfix for STUDIO-757 ###
  #AllowEncodedSlashes NoDecode
  ######

  RequestHeader add X-Forwarded-Proto "https"

  KeepAlive On

  ### Balancer ###########################

  <Proxy balancer://studio-cluster>
    BalancerMember http://@STUDIO_HOST@:@STUDIO_HTTP_PORT@ route=@STUDIO_JVM_ROUTE@ loadfactor=1 ttl=300
  </Proxy>
  #
  # Needed for local development, where the studio and the cae run on different tomcats. For
  # retest or production systems this balancer should be the same as the studio cluster
  #
  <Proxy balancer://preview-cluster>
      BalancerMember http://@BY_PREVIEW_HOST@:@TENANT_PREVIEW_HTTP_PORT@ route=@TENANT_PREVIEW_JVM_ROUTE@ loadfactor=1 ttl=300
  </Proxy>

  Include conf.d/global/ssl.inc
  Include conf.d/by-studio/*.inc

</VirtualHost>
