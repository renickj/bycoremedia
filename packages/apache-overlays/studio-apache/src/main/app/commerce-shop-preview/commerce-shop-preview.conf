<VirtualHost *:@STUDIO_APACHE_HTTP_PORT@>
  ServerName @SHOP_PREVIEW_HELIOS_SEGMENT@.@STUDIO_TLD@

  RequestHeader set X-FragmentHost preview
  Header unset X-Frame-Options
  @DEVELOPMENT_FRAGMENT_REQUEST_HEADER@

  ### Balancer ###########################

  <Proxy balancer://commerce-shop-cluster>
    BalancerMember http://@LIVECONTEXT_HOST@ route=shopWorker loadfactor=1 ttl=300
  </Proxy>
  <Proxy balancer://cae-cluster>
      BalancerMember ajp://@STUDIO_HOST@:@PREVIEW_AJP_PORT@ route=@STUDIO_JVM_ROUTE@ loadfactor=1 ttl=300
  </Proxy>

  ### Generic rules ###########################

  Include conf.d/commerce-shop-preview/*.inc
  Include conf.d/global/proxy.commerce-shop.inc

</VirtualHost>

<VirtualHost *:@STUDIO_APACHE_HTTPS_PORT@>
  ServerName @SHOP_PREVIEW_HELIOS_SEGMENT@.@STUDIO_TLD@
  ServerAlias @SHOP_TOOLS_SEGMENT@.@STUDIO_TLD@
  ServerAlias shop-admin.@STUDIO_TLD@
  ServerAlias shop-orgadmin.@STUDIO_TLD@
  ServerAlias shop-console.@STUDIO_TLD@

  RequestHeader set X-FragmentHost preview
  Header unset X-Frame-Options
  @DEVELOPMENT_FRAGMENT_REQUEST_HEADER@

  ### Balancer ###########################

  <Proxy balancer://commerce-shop-cluster>
    BalancerMember https://@LIVECONTEXT_HOST@ route=shopWorker loadfactor=1 ttl=300
  </Proxy>
  <Proxy balancer://cae-cluster>
    BalancerMember ajp://@STUDIO_HOST@:@PREVIEW_AJP_PORT@ route=@STUDIO_JVM_ROUTE@ loadfactor=1 ttl=300
  </Proxy>

  ### Generic rules ###########################

  Include conf.d/global/ssl.inc
  Include conf.d/commerce-shop-preview/*.inc
  Include conf.d/global/proxy.commerce-shop.inc

</VirtualHost>
